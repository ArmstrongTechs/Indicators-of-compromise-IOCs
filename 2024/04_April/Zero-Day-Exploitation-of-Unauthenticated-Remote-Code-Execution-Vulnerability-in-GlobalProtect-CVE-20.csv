+*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-+
| Title: Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400)
| UUID: 835a6c93-28fb-505f-8e36-d2f655be9395
| Date: 2024-04-22
"| Author: Armstrong Techs, Research Lab"
| References: https://www.armstrongtechs.com/
| TLP:CLEAR
+*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-+

Date,Category,Type,Value,Comment
2024-04-15,Payload delivery,malware-type,UPSTYLE,
2024-04-22,Network activity,ip-dst,198.58.109.149,server used by the attacker to host malicious files
2024-04-22,Network activity,ip-dst,144.172.79.92,server used by the attacker to host malicious files
2024-04-22,Network activity,ip-dst,172.233.228.93,server used by the attacker to host malicious files
2024-04-22,Payload delivery,sha256,3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac,UPSTYLE webshell
2024-04-22,Payload delivery,sha256,35a5f8ac03b0e3865b3177892420cb34233c55240f452f00f9004e274a85703c,reverse shell script
2024-04-22,Payload delivery,sha256,755f5b8bd67d226f24329dc960f59e11cb5735b930b4ed30b2df77572efb32e8,post exploitation script
2024-04-22,Payload delivery,sha256,adba167a9df482aa991faaa0e0cde1182fb9acfbb0dc8d19148ce634608bab87,post exploitation script
2024-04-22,Payload delivery,sha256,c1a0d380bf55070496b9420b970dfc5c2c4ad0a598083b9077493e8b8035f1e9,post exploitation script
2024-04-22,Payload delivery,sha256,fe07ca449e99827265ca95f9f56ec6543a4c5b712ed50038a9a153199e95a0b7,post exploitation script
2024-04-22,Payload delivery,sha256,96dbec24ac64e7dd5fef6e2c26214c8fe5be3486d5c92d21d5dcb4f6c4e365b9,post exploitation script
2024-04-22,Payload delivery,sha256,448fbd7b3389fe2aa421de224d065cea7064de0869a036610e5363c931df5b7c,GOST sample
2024-04-22,Payload delivery,sha256,e315907415eb8cfcf3b6a4cd6602b392a3fe8ee0f79a2d51a81a928dbce950f8,post exploitation script
2024-04-22,Payload delivery,sha256,161fd76c83e557269bee39a57baa2ccbbac679f59d9adff1e1b73b0f4bb277a6,reverse shell Go sample
2024-04-22,Network activity,ip-dst,71.9.135.100,Compromised ASUS router used by attacker to interact with compromised devices
2024-04-22,Network activity,ip-dst,89.187.187.69,Surfshark VPN address used in exploitation attempts.
2024-04-22,Network activity,hostname,nhdata.s3-us-west-2.amazonaws.com,Compromised S3 bucket used to host files by UTA0218
2024-04-22,Network activity,ip-dst,23.242.208.175,Compromised ASUS router used by attacker to interact with compromised devices
2024-04-22,Network activity,ip-dst,137.118.185.101,Compromised ASUS router used by attacker to interact with compromised devices
2024-04-22,Network activity,ip-dst,66.235.168.222,Surfshark VPN address used in exploitation attempts.
2024-04-16,Network activity,url,http://172.233.228.93/policy,
2024-04-16,Network activity,ip-dst,172.233.228.93,
2024-04-16,Network activity,port,80,
2024-04-16,Other,text,/policy,
2024-04-16,Other,text,http,
2024-04-16,Network activity,url,http://172.233.228.93/vpn_prot.gz,
2024-04-16,Network activity,ip-dst,172.233.228.93,
2024-04-16,Other,text,/vpn_prot.gz,
2024-04-16,Other,text,http,
2024-04-16,Payload delivery,sha256,755f5b8bd67d226f24329dc960f59e11cb5735b930b4ed30b2df77572efb32e8,
2024-04-16,Payload delivery,md5,a43e3cf908244f85b237fdbacd8d82d5,
2024-04-16,Payload delivery,sha1,e1e427c9b46064e2b483f90b13490e6ef522cc06,
2024-04-16,Payload delivery,filename,policy,
2024-04-16,Other,size-in-bytes,287,
2024-04-16,Artifacts dropped,mime-type,text/x-shellscript,
2024-04-16,Payload delivery,md5,5e4c623296125592256630deabdbf1d2,
2024-04-16,Payload delivery,sha1,d12b614e9417c4916d5c5bb6ee42c487c937c058,
2024-04-16,Payload delivery,sha256,adba167a9df482aa991faaa0e0cde1182fb9acfbb0dc8d19148ce634608bab87,
2024-04-16,Payload delivery,filename,policy,
2024-04-16,Other,size-in-bytes,216,
2024-04-16,Artifacts dropped,mime-type,text/x-shellscript,
2024-04-16,Payload delivery,md5,0c1554888ce9ed0da1583dbdf7b31651,
2024-04-16,Payload delivery,sha1,988fc0d23e6e30c2c46ccec9bbff50b7453b8ba9,
2024-04-16,Payload delivery,sha256,3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac,
2024-04-16,Payload delivery,filename,update.py,
2024-04-16,Other,size-in-bytes,5187,
2024-04-16,Artifacts dropped,mime-type,text/plain,
2024-04-16,External analysis,link,https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/,
2024-04-16,External analysis,link,https://feedly.com/i/entry/SG03MBDje9fnXXqVZRKtlhAkAtCbTs9u3cVOgZpqVeE=_18ed38c2f0a:16ab7af:e56ebecb,
2024-04-16,Payload delivery,md5,87312a7173889a8a5258c68cac4817bd,
2024-04-16,Payload delivery,sha256,c1a0d380bf55070496b9420b970dfc5c2c4ad0a598083b9077493e8b8035f1e9,
2024-04-16,Payload delivery,sha1,3ad9be0c52510cbc5d1e184e0066d14c1f394d4d,
2024-04-16,Payload delivery,filename,policy,
2024-04-16,Artifacts dropped,mime-type,text/x-shellscript,
2024-04-16,Other,size-in-bytes,388,
2024-04-16,Payload delivery,md5,12b5e30c2276664e87623791085a3221,
2024-04-16,Payload delivery,sha256,96dbec24ac64e7dd5fef6e2c26214c8fe5be3486d5c92d21d5dcb4f6c4e365b9,
2024-04-16,Payload delivery,sha1,f99779a5c891553ac4d4cabf928b2121ca3d1a89,
2024-04-16,Payload delivery,filename,policy,
2024-04-16,Other,size-in-bytes,421,
2024-04-16,Artifacts dropped,mime-type,text/x-shellscript,
2024-04-16,Payload delivery,sha256,fe07ca449e99827265ca95f9f56ec6543a4c5b712ed50038a9a153199e95a0b7,
2024-04-16,Payload delivery,sha1,d7a8d8303361ffd124cb64023095da08a262cab4,
2024-04-16,Payload delivery,md5,b9f5e9db9eec8d1301026c443363cf6b,
2024-04-16,Payload delivery,filename,policy,
2024-04-16,Artifacts dropped,mime-type,text/x-shellscript,
2024-04-16,Other,size-in-bytes,388,
2024-04-16,Payload delivery,sha1,4ad043c8f37a916761b4c815bed23f036dfb7f77,
2024-04-16,Payload delivery,sha256,448fbd7b3389fe2aa421de224d065cea7064de0869a036610e5363c931df5b7c,
2024-04-16,Payload delivery,md5,089801d87998fa193377b9bfe98e87ff,
2024-04-16,Payload delivery,filename,gost-linux-amd64,
2024-04-16,Artifacts dropped,mime-type,application/x-elf,
2024-04-16,Other,size-in-bytes,13578240,
2024-04-16,Payload delivery,sha1,5592434c40a30ed2dfdba0a86832b5f2eaaa437c,
2024-04-16,Payload delivery,md5,724c8059c150b0f3d1e0f80370bcfe19,
2024-04-16,Payload delivery,sha256,e315907415eb8cfcf3b6a4cd6602b392a3fe8ee0f79a2d51a81a928dbce950f8,
2024-04-16,Artifacts dropped,mime-type,text/x-shellscript,
2024-04-16,Other,size-in-bytes,189,
2024-04-16,Payload delivery,filename,policy,
2024-04-16,Payload delivery,sha256,161fd76c83e557269bee39a57baa2ccbbac679f59d9adff1e1b73b0f4bb277a6,
2024-04-16,Payload delivery,md5,427258462c745481c1ae47327182acd3,
2024-04-16,Payload delivery,sha1,ef8036eb4097789577eff62f6c9580fa130e7d56,
2024-04-16,Other,size-in-bytes,3690496,
2024-04-16,Payload delivery,filename,reverse-sshx64,
2024-04-16,Artifacts dropped,mime-type,application/x-elf,
2024-04-16,Payload delivery,md5,0c1554888ce9ed0da1583dbdf7b31651,
2024-04-16,Payload delivery,sha256,3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac,
2024-04-16,Payload delivery,sha1,988fc0d23e6e30c2c46ccec9bbff50b7453b8ba9,
2024-04-16,Payload delivery,filename,update.py,
2024-04-16,Other,size-in-bytes,5187,
2024-04-16,Artifacts dropped,mime-type,text/plain,
2024-04-16,Payload delivery,sha1,a7c6f264b00d13808ceb76b3277ee5461ae1354e,
2024-04-16,Payload delivery,sha256,35a5f8ac03b0e3865b3177892420cb34233c55240f452f00f9004e274a85703c,
2024-04-16,Payload delivery,md5,d31ec83a5a79451a46e980ebffb6e0e8,
2024-04-16,Payload delivery,filename,patch,
2024-04-16,Other,size-in-bytes,160,
2024-04-16,Artifacts dropped,mime-type,text/plain,
2024-04-16,Network activity,url,http://172.233.228.93/vpn_prot.gz,
2024-04-16,Network activity,ip-dst,172.233.228.93,
2024-04-16,Other,text,http,
2024-04-16,Network activity,port,80,
2024-04-16,Network activity,url,http://172.233.228.93/lowdp,
2024-04-16,Network activity,ip-dst,172.233.228.93,
2024-04-16,Other,text,http,
2024-04-16,Network activity,port,80,
2024-04-16,Network activity,url,http://worldtimeapi.org/api/timezone/etc/utc,
2024-04-16,Other,text,org,
2024-04-16,Other,text,worldtimeapi,
2024-04-16,Other,text,worldtimeapi,
2024-04-16,Network activity,hostname,worldtimeapi.org,
2024-04-16,Other,text,http,
2024-04-16,Network activity,port,80,
2024-04-16,Network activity,url,http://172.233.228.93/vpn.log,
2024-04-16,Network activity,ip-dst,172.233.228.93,
2024-04-16,Other,text,http,
2024-04-16,Network activity,port,80,
2024-04-22,Payload installation,yara,"rule apt_malware_py_upstyle : UTA0218
{
    meta:
        author = ""threatintel@volexity.com""
        date = ""2024-04-11""
        description = ""Detect the UPSTYLE webshell.""
        hash1 = ""3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac""
        hash2 = ""0d59d7bddac6c22230187ef6cf7fa22bca93759edc6f9127c41dc28a2cea19d8""
        hash3 = ""4dd4bd027f060f325bf6a90d01bfcf4e7751a3775ad0246beacc6eb2bad5ec6f""
        os = ""linux""
        os_arch = ""all""
        report = ""TIB-20240412""
        scan_context = ""file,memory""
        last_modified = ""2024-04-12T13:05Z""
        license = ""See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt""
        rule_id = 10429
        version = 2

    strings:
        $stage1_str1 = ""/opt/pancfg/mgmt/licenses/PA_VM""
        $stage1_str2 = ""exec(base64.""

        $stage2_str1 = ""signal.signal(signal.SIGTERM,stop)""
        $stage2_str2 = ""exec(base64.""

        $stage3_str1 = ""write(\""/*\""+output+\""*/\"")""
        $stage3_str2 = ""SHELL_PATTERN""

    condition:
        all of ($stage1*) or
        all of ($stage2*) or
        all of ($stage3*)
}",
2024-04-22,Other,text,apt_malware_py_upstyle,
2024-04-22,External analysis,link,https://github.com/volexity/threat-intel/blob/main/2024/2024-04-12%20Palo%20Alto%20Networks%20GlobalProtect/indicators/rules.yar,
2024-04-22,Payload installation,yara,"rule susp_any_gost_arguments
{
    meta:
        author = ""threatintel@volexity.com""
        date = ""2024-04-10""
        description = ""Looks for common arguments passed to the hacktool GOST that are sometimes used by attackers in scripts (for example cronjobs etc).""
        os = ""all""
        os_arch = ""all""
        report = ""TIB-20240412""
        scan_context = ""file""
        last_modified = ""2024-04-12T13:06Z""
        license = ""See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt""
        rule_id = 10425
        version = 2

    strings:
        $s1 = ""-L=socks5://"" ascii
        $s2 = ""-L rtcp://"" ascii

    condition:
        filesize < 10KB and
        any of them
}",
2024-04-22,Other,text,susp_any_gost_arguments,
2024-04-22,External analysis,link,https://github.com/volexity/threat-intel/blob/main/2024/2024-04-12%20Palo%20Alto%20Networks%20GlobalProtect/indicators/rules.yar,
2024-04-22,Payload installation,yara,"rule susp_any_jarischf_user_path
{
    meta:
        author = ""threatintel@volexity.com""
        date = ""2024-04-10""
        description = ""Detects paths embedded in samples in released projects written by Ferdinand Jarisch, a pentester in AISEC. These tools are sometimes used by attackers in real world intrusions.""
        hash1 = ""161fd76c83e557269bee39a57baa2ccbbac679f59d9adff1e1b73b0f4bb277a6""
        os = ""all""
        os_arch = ""all""
        report = ""TIB-20240412""
        scan_context = ""file,memory""
        last_modified = ""2024-04-12T13:06Z""
        license = ""See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt""
        rule_id = 10424
        version = 4

    strings:
        $proj_1 = ""/home/jarischf/""

    condition:
        any of ($proj_*)
}",
2024-04-22,Other,text,rule susp_any_jarischf_user_path,
2024-04-22,External analysis,link,https://github.com/volexity/threat-intel/blob/main/2024/2024-04-12%20Palo%20Alto%20Networks%20GlobalProtect/indicators/rules.yar,
2024-04-22,External analysis,link,https://github.com/volexity/threat-intel/blob/main/2024/2024-04-12%20Palo%20Alto%20Networks%20GlobalProtect/indicators/rules.yar,
2024-04-22,Payload installation,yara,"rule hacktool_golang_reversessh_fahrj
{
    meta:
        author = ""threatintel@volexity.com""
        date = ""2024-04-10""
        description = ""Detects a reverse SSH utility available on GitHub. Attackers may use this tool or similar tools in post-exploitation activity.""
        hash1 = ""161fd76c83e557269bee39a57baa2ccbbac679f59d9adff1e1b73b0f4bb277a6""
        os = ""all""
        os_arch = ""all""
        reference = ""https://github.com/Fahrj/reverse-ssh""
        report = ""TIB-20240412""
        scan_context = ""file,memory""
        last_modified = ""2024-04-12T13:06Z""
        license = ""See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt""
        rule_id = 10423
        version = 5

    strings:
        $fun_1 = ""createLocalPortForwardingCallback""
        $fun_2 = ""createReversePortForwardingCallback""
        $fun_3 = ""createPasswordHandler""
        $fun_4 = ""createPublicKeyHandler""
        $fun_5 = ""createSFTPHandler""
        $fun_6 = ""dialHomeAndListen""
        $fun_7 = ""createExtraInfoHandler""
        $fun_8 = ""createSSHSessionHandler""
        $fun_9 = ""createReversePortForwardingCallback""

        $proj_1 = ""github.com/Fahrj/reverse-ssh""

    condition:
        any of ($proj_*) or
        4 of ($fun_*)
}",
2024-04-22,Other,text,rule hacktool_golang_reversessh_fahrj,
